import matplotlib.pyplot as plt
import numpy as np

x = np.arange(1, 62)
testing_accuracies = [0.71034375, 0.702875, 0.6629375, 0.67665625, 0.6620625, 0.64971875, 0.6424375, 0.65215625, 0.65325, 0.65690625, 0.66784375, 0.6738125, 0.67353125, 0.67915625, 0.68415625, 0.683125, 0.68771875, 0.698125, 0.69209375, 0.692875, 0.6923125, 0.69271875, 0.69771875, 0.700125, 0.7093125, 0.69925, 0.6964375, 0.7064375, 0.713125, 0.71290625, 0.71509375, 0.71090625, 0.71909375, 0.7129375, 0.71559375, 0.71753125, 0.71878125, 0.72290625, 0.72615625, 0.71946875, 0.720875, 0.7264375, 0.71840625, 0.73090625, 0.724, 0.72934375, 0.72440625, 0.73353125, 0.73925, 0.7310625, 0.7446875, 0.76321875, 0.7566875, 0.7585625, 0.76684375, 0.75446875, 0.75559375, 0.7659375, 0.75771875, 0.76209375, 0.76409375]
testing_det_cls = [0.806059758911084, 0.7970293855443596, 0.8422836693823338, 0.8302519645243883, 0.8338609398901462, 0.8305332483947278, 0.8337769650518895, 0.8099720633327961, 0.7928746078014374, 0.7972494923472404, 0.7671067492961884, 0.7571747690439224, 0.7475884649902582, 0.7209143970534205, 0.7221864079684019, 0.7133346800357103, 0.6988538130819798, 0.6858419652283192, 0.6838456837162376, 0.6975288256257772, 0.6858382755219936, 0.679816250115633, 0.6766667033135891, 0.6675709255188703, 0.654864289328456, 0.6719835275784135, 0.6677454707324505, 0.6554221815168858, 0.6478432544022799, 0.6512988810017705, 0.6433052700720727, 0.6521509874016046, 0.6348279479295015, 0.6383163500521332, 0.6355758204832673, 0.6290899204835295, 0.6411306944973767, 0.6222695957645774, 0.6192607057467103, 0.6217828234508633, 0.6191982937604189, 0.6147201130222529, 0.6229210518524051, 0.6049351026266814, 0.6104607801474631, 0.6068810985535383, 0.620686404965818, 0.6016509912908077, 0.5959260734841227, 0.5973573919385672, 0.5832512925192713, 0.551557771615684, 0.5559413725510239, 0.5503899055346847, 0.5379178167432547, 0.5538362859636545, 0.5532699470371008, 0.550675090111792, 0.5514976307079196, 0.5424694078136235, 0.5461932949442416]
testing_det_regr = [0.4630325548648834, 0.4427005752325058, 0.4391162554770708, 0.4450890320688486, 0.4497379770427942, 0.441942338347435, 0.43928938439488413, 0.427962699458003, 0.41738212513923645, 0.4125768376141787, 0.3925645048506558, 0.37341825633496045, 0.36738541422784327, 0.3471354486271739, 0.3339702184647322, 0.3207881170511246, 0.3125270042195916, 0.300043757326901, 0.29071087975427506, 0.28572127885371446, 0.27796924405545, 0.2687380338907242, 0.26477959962189196, 0.2592038680687547, 0.24950264999270438, 0.24748959819599986, 0.24256159266084432, 0.24090271928161383, 0.232467155367136, 0.23276401555910706, 0.22708663857355713, 0.2318449977748096, 0.22690364749357103, 0.22193155090883374, 0.21823945612460374, 0.22066005324572324, 0.21530964739993214, 0.2142838516831398, 0.210564393972978, 0.21337377326749266, 0.20941998420283198, 0.21070343626849353, 0.20614883636683226, 0.20291117637977005, 0.20085234436020255, 0.2088908512480557, 0.20268060741201044, 0.1985428461674601, 0.19994723357073962, 0.2026699418053031, 0.18843414847925305, 0.1879461578205228, 0.1868160362765193, 0.18787486701272427, 0.18512133924290539, 0.18432204155810178, 0.18535124210640788, 0.18299046426266433, 0.18001048610173165, 0.18090314198844135, 0.18446173080056905]
testing_losses = [3.799879411504783, 3.7328497058890746, 3.7924746914271594, 3.6337976515529946, 3.5509340707428496, 3.337557505855687, 3.359030949049186, 3.299849636226688, 3.238783288851347, 3.178462334766418, 3.113963844194846, 3.220125702367952, 3.2217244765806226, 3.13183358090171, 3.083967239242777, 2.8236386709265955, 2.782516160758912, 2.629472213250559, 2.7289401227830585, 2.5711646265854267, 2.4192585385198653, 2.3007851883001305, 2.3860743297142255, 2.3557062954975323, 2.267789954035421, 2.2274762267553405, 2.171223507937223, 2.1454563697318205, 2.147842767345228, 2.190429338174585, 2.0794601460328, 2.159873801645101, 2.1118690117877503, 2.0861158771049033, 2.0246377918802825, 2.061818750268043, 1.971192144979589, 1.9752213384265478, 2.0452564913019406, 1.9932723190258994, 1.9756385650180566, 2.0303387548687115, 1.952245920895901, 1.8747617601574011, 1.9187754340336207, 1.9524052370623088, 1.905927426832446, 1.9082266130701162, 1.9147511437996503, 1.993007522418884, 1.7276076894741286, 1.8404393054408767, 1.906300870631543, 1.856256131951464, 1.8028178981252183, 1.8580777048507635, 1.8371992050924453, 1.8309404666374836, 1.9213537840067931, 1.8376296416304094, 1.8752971896703756]
testing_rpn_cls = [2.4073132786834655, 2.3763437371621356, 2.3960696843863327, 2.2437133816391497, 2.15314285660784, 1.9524907632801922, 1.9744387886948178, 1.945772221456543, 1.9162138024470432, 1.8538910237582327, 1.8393684244852755, 1.9772960004067013, 1.995879202227223, 1.9548297619704196, 1.9163914645521751, 1.681830531203801, 1.6630431875629597, 1.537148998409251, 1.644520666165152, 1.4797484280973345, 1.3495849882787037, 1.2440074619064716, 1.3382372226784283, 1.3208777355029515, 1.2565109573051978, 1.2043479620434039, 1.1569924792632855, 1.144390213260672, 1.1631293299254943, 1.2007900123554909, 1.1047100274037245, 1.1719559096594807, 1.1446629001169295, 1.1243713699836322, 1.0671290919486123, 1.106826722935968, 1.0146301024450048, 1.0387951306280145, 1.1109617997452255, 1.0569582802444502, 1.0449202621690747, 1.1015369611411534, 1.0203301518744086, 0.9651824244666923, 1.0083276033542599, 1.0351111683870533, 0.9817147123920238, 1.0071823839358975, 1.0170858992473433, 1.0934959241028628, 0.8651880905193987, 1.0108077989688657, 1.0735123743970598, 1.027062573562609, 0.9884949816731436, 1.0301325085680628, 1.0065900319940408, 1.0064399697960986, 1.0988896560319759, 1.023773581711531, 1.05309397680888]
testing_rpn_regr = [0.12347381904534996, 0.1167760079500731, 0.11500508218142204, 0.11474327332060784, 0.11419229720206932, 0.11259115583333187, 0.11152581090759486, 0.11614265197934583, 0.11231275346362964, 0.11474498104676605, 0.11492416556272655, 0.11223667658236809, 0.11087139513529837, 0.10895397325069643, 0.11141914825746789, 0.10768534263595939, 0.108092155894381, 0.10643749228608794, 0.10986289314739406, 0.10816609400860033, 0.10586603066371754, 0.10822344238730147, 0.10639080410031601, 0.10805376640695613, 0.10691205740906298, 0.1036551389375236, 0.10392396528064274, 0.10474125567264855, 0.10440302765031811, 0.1055764292582171, 0.10435820998344571, 0.10392190680920613, 0.1054745162477484, 0.10149660616030451, 0.10369342332379893, 0.10524205360282213, 0.10012170063727535, 0.09987276035081595, 0.10446959183702711, 0.10115744206309318, 0.10210002488573082, 0.10337824443681165, 0.10284588080225512, 0.10173305668425746, 0.09913470617169515, 0.10152211887366139, 0.10084570206259377, 0.10085039167595096, 0.10179193749744445, 0.09948426457215101, 0.0907341579562053, 0.09012757703580428, 0.09003108740694006, 0.09092878584144637, 0.09128376046591438, 0.08978686876094434, 0.09198798395489576, 0.09083494246692862, 0.09095601116516627, 0.0904835101168137, 0.09154818711668486]
training_accuracies = [0.713375, 0.719375, 0.6665625, 0.69075, 0.66740625, 0.655875, 0.656, 0.6605625, 0.661, 0.65834375, 0.67334375, 0.68140625, 0.69096875, 0.69409375, 0.70228125, 0.694875, 0.69909375, 0.707375, 0.70140625, 0.71384375, 0.70975, 0.7091875, 0.710375, 0.71603125, 0.7221875, 0.7135625, 0.71784375, 0.7216875, 0.73034375, 0.73165625, 0.72725, 0.73490625, 0.728375, 0.732875, 0.74009375, 0.73178125, 0.74434375, 0.74428125, 0.735125, 0.7325, 0.7478125, 0.7458125, 0.74421875, 0.74234375, 0.7554375, 0.75053125, 0.750125, 0.75678125, 0.7505625, 0.75215625, 0.7555625, 0.759125, 0.743, 0.75296875, 0.75440625, 0.75346875, 0.75328125, 0.762375, 0.75790625, 0.76128125, 0.75521875]
training_det_cls = [0.7973921437542886, 0.7662448287606239, 0.8302401409447193, 0.7992054799348116, 0.8140561968237162, 0.8341159643828869, 0.8067884751558304, 0.788525972828269, 0.7868611313551664, 0.7776201894879341, 0.7541963893100619, 0.7402334173321724, 0.7126408322006464, 0.7019148344993591, 0.6950999326258898, 0.6964561658650636, 0.6862336463704706, 0.6682862488180399, 0.6743937222659588, 0.6515252880603075, 0.6703592407107353, 0.6618735628575086, 0.6490277719199657, 0.64952929392457, 0.6468217677623034, 0.6469843383580446, 0.6399971247538925, 0.6367299763262272, 0.6190019624382257, 0.6166373635008932, 0.6217760281041265, 0.6129481255784631, 0.6233153345435858, 0.6083676092773675, 0.5965263349711895, 0.6074499851390719, 0.5853643845319748, 0.5945637740567327, 0.6010665763691068, 0.6028718850538135, 0.580128710322082, 0.577016571380198, 0.5852822779193521, 0.5877939891703426, 0.5658088562488556, 0.5750837001278997, 0.5702981382161378, 0.5569842153564095, 0.5777051595449447, 0.5665943565890192, 0.5571092583686114, 0.5615311589501798, 0.5745347855463624, 0.5528049510866404, 0.5536557959541678, 0.5563437325060367, 0.5548971576839685, 0.54719987565279, 0.5469751692600548, 0.5417886716183274, 0.5524656057842076]
training_det_regr = [0.45981776393204926, 0.4373094795048237, 0.44302837989851834, 0.43259083683788774, 0.4519520085901022, 0.44166093215346336, 0.4289241203889251, 0.43144788293354214, 0.4224103143885732, 0.4025798307135701, 0.386990630120039, 0.3658729429244995, 0.35879758117347954, 0.34787633138149976, 0.329226765088737, 0.3157311929017305, 0.30270180594548585, 0.2933007745072246, 0.2857739644944668, 0.2828693757690489, 0.26999631406366825, 0.2667648423761129, 0.2593318627104163, 0.2596099133491516, 0.24306510416418314, 0.24596899416297674, 0.23612776135280727, 0.2356999476738274, 0.23021892712265252, 0.2270100353397429, 0.22215432979911565, 0.22851458471640945, 0.2219281531907618, 0.21486373060941696, 0.21197446371987463, 0.219002303853631, 0.20569243182986974, 0.2110071756094694, 0.20995886306092143, 0.2055378438681364, 0.19854536953195928, 0.19975414576008915, 0.1995259388871491, 0.19512820587679744, 0.1924922446999699, 0.19878093326464297, 0.18781279032491147, 0.18492700401321052, 0.19126590755023062, 0.19395788467302919, 0.18775779376924037, 0.18278719831630588, 0.18818851807713508, 0.18422110917791723, 0.18010719573311507, 0.18180972280539573, 0.17471231293864548, 0.17601472593471407, 0.1728915482275188, 0.18070952488668263, 0.17529451786167918]
training_losses = [3.89878628255771, 3.6925684288639617, 3.713188141365656, 3.7760263889358594, 3.4914557088572957, 3.4995001351035997, 3.3125231615306197, 3.357643412359053, 3.358300292072356, 3.2449021346765647, 3.2571789185915136, 3.2127277960859137, 3.0378196252456187, 3.008769843152317, 2.896966689415041, 2.9376026672360824, 2.6544604889666394, 2.498313193148198, 2.6830424842065637, 2.4064267839793536, 2.3596034379937145, 2.2835526037714606, 2.236596059371849, 2.3310519752851273, 2.0998379328217815, 2.195924171856206, 2.1907811290833155, 2.1780215138444183, 2.054966911437915, 2.160381484344712, 2.0224825725905493, 2.105850876017892, 2.0857151479969476, 1.8915778760459907, 1.9999535901209633, 2.049036318344039, 1.9579891274365369, 1.897083822493804, 1.9117380183056765, 1.7619718967509375, 1.7799490920928147, 1.8597893269021595, 1.8607395134213327, 1.8250901956626415, 1.8135201141661057, 1.8198342603604045, 1.729519383508632, 1.79334312434813, 1.91839405245216, 1.757010675110818, 1.8069995075277558, 1.803194600059113, 1.799453527641184, 1.7494481659122827, 1.739794549893746, 1.7746241940127645, 1.7188476065410898, 1.7425741765539593, 1.6596828737838605, 1.7375483266027325, 1.7445440282039002]
training_mean_bounding = [9.97, 9.72, 11.71, 10.672, 11.582, 12.19, 12.391, 12.141, 12.212, 12.907, 12.807, 13.411, 13.018, 13.404, 13.732, 14.213, 14.655, 15.004, 15.315, 14.878, 16.252, 16.129, 16.321, 16.269, 17.2, 17.162, 17.333, 17.208, 17.796, 17.144, 17.849, 17.783, 18.001, 18.203, 17.652, 17.931, 18.43, 18.911, 17.957, 18.304, 18.208, 18.399, 18.897, 18.945, 18.575, 18.862, 18.609, 18.039, 19.343, 18.951, 18.916, 18.989, 18.961, 19.2, 19.196, 18.938, 19.788, 19.544, 20.232, 19.391, 18.949]
training_rpn_cls = [2.517469191359072, 2.377459047211757, 2.330004604308986, 2.4320650076732253, 2.1106035142090596, 2.1146908703583853, 1.968841091462769, 2.026118022849079, 2.041521606102706, 1.9553735367150358, 2.004007283372618, 2.000732402195958, 1.8586761552610918, 1.851601728852431, 1.7622347387159223, 1.8204384201886932, 1.566795654489865, 1.4353730764814752, 1.6185151419239203, 1.3682924203903604, 1.3192991797465756, 1.2521906511081777, 1.2258649197358324, 1.3223309788119102, 1.1113193293332115, 1.2034775287075408, 1.215245325370178, 1.2049494294985634, 1.107806087540515, 1.219560287784313, 1.0825538393930427, 1.1655807276565568, 1.1440512260550608, 0.9776908134796358, 1.094820644736599, 1.1255391162506176, 1.0749060833950066, 0.9966967476940616, 1.007034423797212, 0.8572301401887356, 0.9088442337457165, 0.991504636797007, 0.9815135429053513, 0.9511815501183242, 0.9622928122767154, 0.9547808063424393, 0.8828990750628947, 0.9605807292594527, 1.0599898458210952, 0.9033714259301999, 0.9703702483548124, 0.9669589598461613, 0.9412140211855802, 0.9264423676893198, 0.9187033110001773, 0.9444182431402576, 0.8997394443938641, 0.9307211478113628, 0.8503548433822523, 0.9260695135850142, 0.929330657568959]
training_rpn_regr = [0.12410718351230025, 0.1115550733867567, 0.10991501621343196, 0.11216506448993459, 0.11484398923441767, 0.10903236820886378, 0.10796947452309541, 0.11155153374816291, 0.10750724022591021, 0.10932857776002493, 0.11198461578879505, 0.10588903363328427, 0.10770505661040079, 0.10737694841902704, 0.11040525298449211, 0.10497688828059472, 0.09872938216081821, 0.10135309334145859, 0.10435965552221751, 0.10373969975963701, 0.09994870347273536, 0.10272354742966126, 0.10237150500563438, 0.09958178919949569, 0.09863173156208359, 0.09949331062764395, 0.09941091760643758, 0.10064216034580022, 0.09793993433652212, 0.09717379771976266, 0.0959983752942644, 0.09880743806646206, 0.09642043420753907, 0.09065572267957031, 0.09663214669330046, 0.09704491310071899, 0.09202622767968568, 0.09481612513354049, 0.09367815507843624, 0.09633202764025191, 0.092430778493057, 0.0915139729648654, 0.09441775370948016, 0.09098645049717743, 0.09292620094056474, 0.09118882062542252, 0.0885093799046881, 0.09085117571905721, 0.0894331395358895, 0.09308700791856972, 0.0917622070350917, 0.091917282946466, 0.0955162028321065, 0.08597973795840516, 0.0873282472062856, 0.09205249556107446, 0.08949869152461179, 0.08863842715509236, 0.08946131291403435, 0.08898061651270836, 0.0874532469890546]

lines = plt.plot(x, training_mean_bounding, '-')
plt.setp(lines[0], linewidth=2)
plt.setp(lines[1], linewidth=2)
# plt.setp(lines[2], linewidth=2)
# plt.setp(lines[2], linewidth=2)
plt.title('Epochs vs Training mean number of overlapping bounding boxes')
plt.show()

#Mean number of bounding boxes from RPN overlapping ground truth boxes: 21.141
#Classifier accuracy for bounding boxes from RPN: 0.8995